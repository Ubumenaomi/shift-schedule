<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>排班系統</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</head>
<body>
  <header>
    <h1>排班系統 Shift Scheduler</h1>
  </header>
<main>
  <div id="main-container">
    <!-- 側邊欄：人員清單、休假設定、互斥設定、摘要 -->
    <aside id="sidebar">
      <!-- 人員清單 -->
      <section id="staff-list">
        <h2>人員清單</h2>
        <ul><!-- JS 生成人員列表 --></ul>
        <div id="add-staff">
          <select id="staff-role">
            <option value="PGY1">PGY1</option>
            <option value="PGY2">PGY2</option>
            <option value="R1">R1</option>
            <option value="R2">R2</option>
            <option value="R3">R3</option>
            <option value="F1">F1</option>
            <option value="F2">F2</option>
            <option value="Vs">Vs</option>
          </select>
          <input type="text" id="new-staff-name" placeholder="輸入人員姓名">
          <button id="add-staff-button">新增人員</button>
        </div>
      </section>

      <!-- 預班（休假）設定 -->
      <section id="off-days">
        <h3>預班（休假）設定</h3>
        <label>選擇人員：
          <select id="off-staff-select">
            <option value="">-- 請選擇 --</option>
          </select>
        </label>
        <label>預班日（最多 8 天）：
          <input type="text" id="off-days-picker" placeholder="點此選擇日期" readonly />
        </label>
        <button id="set-off-days">儲存</button>
        <div id="off-days-list"><!-- JS 渲染休假列表 --></div>
      </section>

      <!-- 互斥排班設定 -->
      <section id="exclusion-panel">
        <h3>互斥排班設定</h3>
        <!-- …內容… -->
      </section>

      <!-- 週末 & 本月排班次數摘要 -->
      <section id="weekend-summary">
        <!-- JS 渲染週末 & 本月摘要 -->
      </section>
    </aside>

    <!-- 主排班區 -->
    <section id="schedule-container">
      <!-- 排班控制列 -->
      <div id="schedule-header">
        年份：<input id="year" type="number" value="2025" style="width:4em;">
        月份：<input id="month" type="number" value="7" style="width:3em;">
        <button id="generate-button">產生排班表</button>
        <button id="auto-schedule">自動排班</button>
        <button id="set-disabled-button">設定禁用格</button>
        <button id="export-excel">匯出排班（Excel）</button>
        <button id="export-csv">匯出排班（CSV）</button>
      </div>

      <!-- 可捲動表格 -->
      <div id="schedule-wrapper">
        <table id="schedule">
          <thead>
            <tr>
              <th>日期</th><th>6W</th><th>Zone A</th><th>Zone B</th>
              <th>MICU1</th><th>MICU2</th><th>總值</th>
            </tr>
          </thead>
          <tbody>
            <!-- generateSchedule() 會動態填入 -->
          </tbody>
        </table>
      </div>
    </section>
  </div>
</main>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="script.js" defer></script>
</body>
</html>
